# 一. 认识`Vue`的动画原理

---

## 1.认识动画

- 在开发中，我们想要给一个组件的显示和消失添加某种过渡动画，可以很好的增加用户体验： 

  - `React`框架本身并没有提供任何动画相关的`API`，所以在`React`中使用过渡动画我们需要使用一个第三方库` react-transition-group`
  - `Vue`中为我们提供一些内置组件和对应的`API`来完成动画，利用它们我们可以方便的实现过渡动画效果

- 我们来看一个案例：

  - `Hello World`的显示和隐藏

  <img src="C:\Users\23634\AppData\Roaming\Typora\typora-user-images\image-20220817142825639.png" alt="image-20220817142825639" style="zoom:67%;" />

  - 通过`v-if`实现，是不会有任何动画效果的

- 没有动画的情况下，整个内容的显示和隐藏会非常的生硬：

  - 如果我们希望给单元素或者组件实现过渡动画，可以使用` transition `内置组件来完成动画

## 2.`Vue`的`transition`动画

- `Vue `提供了` transition `的封装组件，在下列情形中，可以给任何元素和组件添加进入/离开过渡：

  - 条件渲染 (使用` v-if`)条件展示 (使用` v-show`)
  - 动态组件
  - 组件根节点

  <img src="C:\Users\23634\AppData\Roaming\Typora\typora-user-images\image-20220817143244558.png" alt="image-20220817143244558" style="zoom:67%;" />

  

<img src="C:\Users\23634\AppData\Roaming\Typora\typora-user-images\image-20220817143257259.png" alt="image-20220817143257259" style="zoom:67%;" />

## 3.`Transition`组件的原理

- 我们会发现，`Vue`自动给`h2`元素添加了动画，这是什么原因呢？
- 当插入或删除包含在` transition `组件中的元素时，`Vue `将会做以下处理：
  - 1.自动检测目标元素是否应用了`CSS`过渡或者动画，如果有，那么在恰当的时机添加/删除` CSS`类名
  - 2.如果` transition `组件提供了`js`钩子函数，这些钩子函数将在恰当的时机被调用
  - 3.如果没有找到`js`钩子并且也没有检测到`CSS`过渡/动画，`DOM`插入、删除操作将会立即执行
- 那么都会添加或者删除哪些`class`呢？





# 二. 动画中常见类的作用

---

## 1.过渡动画`class`

- 我们会发现上面提到了很多个`class`，事实上`Vue`就是帮助我们在这些`class`之间来回切换完成的动画：
- `v-enter-from`：定义进入过渡的开始状态
  - 在元素被插入之前生效，在元素被插入之后的下一帧移除
- `v-enter-active`：定义进入过渡生效时的状态
  - 在整个进入过渡的阶段中应用，在元素被插入之前生效，在过渡/动画完成之后移除。这个类可以被用来定义进入过渡的过程时间，延迟和曲线函数
- `v-enter-to`：定义进入过渡的结束状态
  - 在元素被插入之后下一帧生效 (与此同时` v-enter-from `被移除)，在过渡/动画完成之后移除
- `v-leave-from`：定义离开过渡的开始状态
  - 在离开过渡被触发时立刻生效，下一帧被移除
- `v-leave-active`：定义离开过渡生效时的状态
  - 在整个离开过渡的阶段中应用，在离开过渡被触发时立刻生效，在过渡/动画完成之后移除。这个类可以被用来定义离开过渡的过程时间，延迟和曲线函数
- `v-leave-to`：离开过渡的结束状态
  - 在离开过渡被触发之后下一帧生效 (与此同时` v-leave-from `被删除)，在过渡/动画完成之后移除

## 2.`class`添加的时机和命名规则

<img src="C:\Users\23634\AppData\Roaming\Typora\typora-user-images\image-20220817143737915.png" alt="image-20220817143737915" style="zoom:67%;" />

- `class`的`name`命名规则如下：
  - 如果我们使用的是一个没有`name`的`transition`，那么所有的`class`是以` v- `作为默认前缀
  - 如果我们添加了一个`name`属性，比如` <transtion name="aaa">`，那么所有的`class`会以` aaa- `开头





# 三. `animation`动画实现

---

## 1.`animation`动画实现

- 前面我们是通过`transition`来实现的动画效果，另外我们也可以通过`animation`来实现

<img src="C:\Users\23634\AppData\Roaming\Typora\typora-user-images\image-20220817143919683.png" alt="image-20220817143919683" style="zoom:67%;" />

## 2.同时设置过渡和动画（一般不设置）

- `Vue`为了知道过渡的完成，内部是在监听` transitionend `或` animationend`，到底使用哪一个取决于元素应用的`CSS`规则：
  - 如果我们只是使用了其中的一个，那么`Vue`能自动识别类型并设置监听
- 但是如果我们同时使用了过渡和动画呢？
  - 并且在这个情况下可能某一个动画执行结束时，另外一个动画还没有结束
  - 在这种情况下，我们可以设置` type `属性为` animation `或者` transition `来明确的告知`Vue`监听的类型

<img src="C:\Users\23634\AppData\Roaming\Typora\typora-user-images\image-20220817144116331.png" alt="image-20220817144116331" style="zoom:67%;" />





# 四. 动画的常见属性设置

---

## 1.显示的指定动画时间

- 我们也可以显示的来指定过渡的时间，通过` duration `属性
- `duration`可以设置两种类型的值：
  - `number`类型：同时设置进入和离开的过渡时间
  - `object`类型：分别设置进入和离开的过渡时间

<img src="C:\Users\23634\AppData\Roaming\Typora\typora-user-images\image-20220817144224614.png" alt="image-20220817144224614" style="zoom:67%;" />

## 2.过渡的模式`mode`

- 我们来看当前的动画在两个元素之间切换的时候存在的问题：

<img src="C:\Users\23634\AppData\Roaming\Typora\typora-user-images\image-20220817144330907.png" alt="image-20220817144330907" style="zoom:67%;" />

- 我们会发现` Hello World `和你好啊，李银河是同时存在的：
  - 这是因为默认情况下进入和离开动画是同时发生的
  - 如果确实我们希望达到这个的效果，那么是没有问题
- 但是如果我们不希望同时执行进入和离开动画，那么我们需要设置`transition`的过渡模式： 
  - `in-out`: 新元素先进行过渡，完成之后当前元素过渡离开
  - `out-in`: 当前元素先进行过渡，完成之后新元素过渡进入

## 3.动态组件的切换

- 上面的示例同样适用于我们的动态组件：

<img src="C:\Users\23634\AppData\Roaming\Typora\typora-user-images\image-20220817144459279.png" alt="image-20220817144459279" style="zoom:67%;" />

## 4.`appear`初次渲染

- 默认情况下，首次渲染的时候是没有动画的，如果我们希望给他添加上去动画，那么就可以增加另外一个属性`appear`：

<img src="C:\Users\23634\AppData\Roaming\Typora\typora-user-images\image-20220817144543650.png" alt="image-20220817144543650" style="zoom:67%;" />





# 五. 列表元素动画组实现

---

## 1.认识列表的过渡

- 目前为止，过渡动画我们只要是针对单个元素或者组件的：
  - 要么是单个节点
  - 要么是同一时间渲染多个节点中的一个
- 那么如果希望渲染的是一个列表，并且该列表中添加删除数据也希望有动画执行呢？
  - 这个时候我们要使用` <transition-group> `组件来完成
- 使用`<transition-group> `有如下的特点：
  - 默认情况下，它不会渲染一个元素的包裹器，但是你可以指定一个元素并以` tag attribute `进行渲染
  - 过渡模式不可用，因为我们不再相互切换特有的元素
  - 内部元素总是需要提供唯一的` key attribute `值
  - `CSS `过渡的类将会应用在内部的元素中，而不是这个组/容器本身

## 2.列表过渡的基本使用

- 我们来做一个案例：
  - 案例是一列数字，可以继续添加或者删除数字
  - 在添加和删除数字的过程中，对添加的或者移除的数字添加动画

<img src="C:\Users\23634\AppData\Roaming\Typora\typora-user-images\image-20220817144725206.png" alt="image-20220817144725206" style="zoom:67%;" />







# 六. 列表元素的移动动画

---

- 在上面的案例中虽然新增的或者删除的节点是有动画的，但是对于哪些其他需要移动的节点是没有动画的：
  - 我们可以通过使用一个新增的` v-move `的`class`来完成动画
  - 它会在元素改变位置的过程中应用
  - 像之前的名字一样，我们可以通过`name`来自定义前缀

<img src="C:\Users\23634\AppData\Roaming\Typora\typora-user-images\image-20220817144819427.png" alt="image-20220817144819427" style="zoom:67%;" />

- 代码如下:

<img src="C:\Users\23634\AppData\Roaming\Typora\typora-user-images\image-20220817145153770.png" alt="image-20220817145153770" style="zoom:67%;" />